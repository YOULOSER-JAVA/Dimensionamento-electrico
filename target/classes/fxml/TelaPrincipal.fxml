<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>

<BorderPane xmlns="http://javafx.com/javafx" 
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="ao.ipddf.dimensionamento.controller.TelaPrincipalController"
            prefHeight="800.0" prefWidth="1200.0">
    
    <!-- Barra de Menu Superior -->
    <top>
        <VBox>
            <!-- MenuBar -->
            <MenuBar>
                <Menu text="Ficheiro">
                    <MenuItem text="Novo Projeto" onAction="#novoProjeto"/>
                    <MenuItem text="Abrir Projeto" onAction="#abrirProjeto"/>
                    <MenuItem text="Guardar Projeto" onAction="#guardarProjeto"/>
                    <SeparatorMenuItem/>
                    <MenuItem text="Sair" onAction="#sair"/>
                </Menu>
                
                <Menu text="Dimensionamento">
                    <MenuItem text="Iluminação" onAction="#abrirIluminacao"/>
                    <MenuItem text="Tomadas" onAction="#abrirTomadas"/>
                    <MenuItem text="Climatização" onAction="#abrirClimatizacao"/>
                    <MenuItem text="Circuitos" onAction="#abrirCircuitos"/>
                    <MenuItem text="Sistema Fotovoltaico" onAction="#abrirFotovoltaico"/>
                </Menu>
                
                <Menu text="Relatórios">
                    <MenuItem text="Memorial Descritivo" onAction="#gerarMemorial"/>
                    <MenuItem text="Tabelas Técnicas" onAction="#gerarTabelas"/>
                    <MenuItem text="Lista de Materiais" onAction="#gerarListaMateriais"/>
                    <MenuItem text="Diagrama Unifilar" onAction="#gerarDiagrama"/>
                </Menu>
                
                <Menu text="Ferramentas">
                    <MenuItem text="Calculadora Elétrica" onAction="#abrirCalculadora"/>
                    <MenuItem text="Tabelas Normativas" onAction="#abrirTabelasNormativas"/>
                </Menu>
                
                <Menu text="Ajuda">
                    <MenuItem text="Manual do Utilizador" onAction="#abrirManual"/>
                    <MenuItem text="Sobre" onAction="#abrirSobre"/>
                </Menu>
            </MenuBar>
            
            <!-- Barra de Ferramentas -->
            <ToolBar>
                <Button text="Novo" onAction="#novoProjeto" styleClass="toolbar-button"/>
                <Button text="Abrir" onAction="#abrirProjeto" styleClass="toolbar-button"/>
                <Button text="Guardar" onAction="#guardarProjeto" styleClass="toolbar-button"/>
                <Separator orientation="VERTICAL"/>
                <Button text="Compartimentos" onAction="#gerenciarCompartimentos" styleClass="toolbar-button"/>
                <Button text="Circuitos" onAction="#abrirCircuitos" styleClass="toolbar-button"/>
                <Separator orientation="VERTICAL"/>
                <Button text="Calcular Tudo" onAction="#calcularTudo" styleClass="toolbar-button-primary"/>
                <Separator orientation="VERTICAL"/>
                <Button text="Gerar Relatório" onAction="#gerarRelatorioCompleto" styleClass="toolbar-button-success"/>
            </ToolBar>
        </VBox>
    </top>
    
    <!-- Área Central -->
    <center>
        <SplitPane dividerPositions="0.3">
            <!-- Painel Esquerdo - Informações do Projeto -->
            <VBox spacing="10" style="-fx-padding: 10;">
                <Label text="Informações do Projeto" style="-fx-font-size: 16px; -fx-font-weight: bold;"/>
                
                <GridPane hgap="10" vgap="10">
                    <Label text="Nome do Projeto:" GridPane.rowIndex="0" GridPane.columnIndex="0"/>
                    <TextField fx:id="txtNomeProjeto" GridPane.rowIndex="0" GridPane.columnIndex="1" 
                               prefWidth="250"/>
                    
                    <Label text="Cliente:" GridPane.rowIndex="1" GridPane.columnIndex="0"/>
                    <TextField fx:id="txtCliente" GridPane.rowIndex="1" GridPane.columnIndex="1"/>
                    
                    <Label text="Endereço:" GridPane.rowIndex="2" GridPane.columnIndex="0"/>
                    <TextField fx:id="txtEndereco" GridPane.rowIndex="2" GridPane.columnIndex="1"/>
                    
                    <Label text="Tipo de Alimentação:" GridPane.rowIndex="3" GridPane.columnIndex="0"/>
                    <ComboBox fx:id="cmbTipoAlimentacao" GridPane.rowIndex="3" GridPane.columnIndex="1"
                              prefWidth="250"/>
                    
                    <Label text="Tensão Nominal (V):" GridPane.rowIndex="4" GridPane.columnIndex="0"/>
                    <TextField fx:id="txtTensaoNominal" GridPane.rowIndex="4" GridPane.columnIndex="1"/>
                </GridPane>
                
                <Separator/>
                
                <Label text="Resumo do Dimensionamento" style="-fx-font-size: 14px; -fx-font-weight: bold;"/>
                
                <VBox spacing="5">
                    <HBox spacing="10">
                        <Label text="Compartimentos:" style="-fx-font-weight: bold;"/>
                        <Label fx:id="lblNumCompartimentos" text="0"/>
                    </HBox>
                    
                    <HBox spacing="10">
                        <Label text="Circuitos:" style="-fx-font-weight: bold;"/>
                        <Label fx:id="lblNumCircuitos" text="0"/>
                    </HBox>
                    
                    <HBox spacing="10">
                        <Label text="Potência Instalada:" style="-fx-font-weight: bold;"/>
                        <Label fx:id="lblPotenciaInstalada" text="0 W"/>
                    </HBox>
                    
                    <HBox spacing="10">
                        <Label text="Potência Contratada:" style="-fx-font-weight: bold;"/>
                        <Label fx:id="lblPotenciaContratada" text="0 KVA"/>
                    </HBox>
                    
                    <HBox spacing="10">
                        <Label text="Corrente de Serviço:" style="-fx-font-weight: bold;"/>
                        <Label fx:id="lblCorrenteServico" text="0 A"/>
                    </HBox>
                </VBox>
                
                <Separator/>
                
                <Label text="Sistema Fotovoltaico" style="-fx-font-size: 14px; -fx-font-weight: bold;"/>
                
                <VBox spacing="5">
                    <HBox spacing="10">
                        <Label text="Painéis Solares:" style="-fx-font-weight: bold;"/>
                        <Label fx:id="lblNumPaineis" text="0 unidades"/>
                    </HBox>
                    
                    <HBox spacing="10">
                        <Label text="Potência Total:" style="-fx-font-weight: bold;"/>
                        <Label fx:id="lblPotenciaPaineis" text="0 Wp"/>
                    </HBox>
                    
                    <HBox spacing="10">
                        <Label text="Baterias:" style="-fx-font-weight: bold;"/>
                        <Label fx:id="lblBaterias" text="0 Ah"/>
                    </HBox>
                    
                    <HBox spacing="10">
                        <Label text="Autonomia:" style="-fx-font-weight: bold;"/>
                        <Label fx:id="lblAutonomia" text="0 dias"/>
                    </HBox>
                </VBox>
            </VBox>
            
            <!-- Painel Direito - TabPane com Diferentes Áreas -->
            <TabPane fx:id="tabPaneMain" tabClosingPolicy="UNAVAILABLE">
                <Tab text="Compartimentos">
                    <VBox spacing="10" style="-fx-padding: 10;">
                        <HBox spacing="10">
                            <Button text="Adicionar Compartimento" onAction="#adicionarCompartimento"/>
                            <Button text="Editar" onAction="#editarCompartimento"/>
                            <Button text="Remover" onAction="#removerCompartimento"/>
                        </HBox>

                        <TableView fx:id="tabelaCompartimentos" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn fx:id="colCompNome" text="Nome" prefWidth="150"/>
                                <TableColumn fx:id="colCompTipo" text="Tipo" prefWidth="120"/>
                                <TableColumn fx:id="colCompArea" text="Área (m²)" prefWidth="80"/>
                                <TableColumn fx:id="colCompLampadas" text="Lâmpadas" prefWidth="80"/>
                                <TableColumn fx:id="colCompTomadasUG" text="Tomadas UG" prefWidth="80"/>

                                <TableColumn text="Tomadas UE" prefWidth="80"/>
                                <TableColumn text="Ar Cond." prefWidth="80"/>
                            </columns>
                        </TableView>
                    </VBox>
                </Tab>
                
                <Tab text="Circuitos">
                    <VBox spacing="10" style="-fx-padding: 10;">
                        <HBox spacing="10">
                            <Button text="Gerar Circuitos Automaticamente" onAction="#gerarCircuitosAuto"/>
                            <Button text="Editar Circuito" onAction="#editarCircuito"/>
                            <Button text="Balancear Fases" onAction="#balancearFases"/>
                        </HBox>
                        
                        <TableView fx:id="tabelaCircuitos" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn text="Nº" prefWidth="50"/>
                                <TableColumn text="Tipo" prefWidth="120"/>
                                <TableColumn text="Fase" prefWidth="50"/>
                                <TableColumn text="Potência (W)" prefWidth="100"/>
                                <TableColumn text="Corrente (A)" prefWidth="100"/>
                                <TableColumn text="Condutor (mm²)" prefWidth="100"/>
                                <TableColumn text="Disjuntor (A)" prefWidth="100"/>
                                <TableColumn text="Curva" prefWidth="60"/>
                            </columns>
                        </TableView>
                    </VBox>
                </Tab>
                
                <Tab text="Dashboard">
                    <ScrollPane fitToWidth="true">
                        <VBox spacing="20" style="-fx-padding: 20;">
                            <Label text="Painel de Controle do Projeto" 
                                   style="-fx-font-size: 20px; -fx-font-weight: bold;"/>
                            
                            <!-- Aqui será inserido gráficos e resumos visuais -->
                            <Label fx:id="lblDashboard" 
                                   text="Utilize o menu superior para dimensionar o projeto"
                                   style="-fx-font-size: 14px;"/>
                        </VBox>
                    </ScrollPane>
                </Tab>
            </TabPane>
        </SplitPane>
    </center>
    
    <!-- Barra de Status Inferior -->
    <bottom>
        <HBox spacing="20" style="-fx-padding: 5 10; -fx-background-color: #f0f0f0;">
            <Label fx:id="lblStatus" text="Pronto" style="-fx-font-weight: bold;"/>
            <Region HBox.hgrow="ALWAYS"/>
            <Label text="Sistema de Dimensionamento Elétrico - IPDDF © 2024"/>
        </HBox>
    </bottom>
    
</BorderPane>